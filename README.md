# ğŸŒŒ SONA - 3D ìŒì•… ìƒì„± ìš°ì£¼ íƒí—˜ í”Œë«í¼ (Backend)

â€œìš°ì£¼ë¥¼ íƒí—˜í•˜ë©° ìŒì•…ì„ ì°½ì¡°í•˜ë‹¤â€
SONAëŠ” 3D ìš°ì£¼ ê³µê°„ì—ì„œ  **ìŠ¤í…”ë¼ ì‹œìŠ¤í…œ(Stellar System)** ì„ ë§Œë“¤ê³ , ê° ì²œì²´ì˜ ë¬¼ë¦¬ì  íŠ¹ì„±ì„ ì¡°ì •í•˜ì—¬ ìŒì•…ì„ ì°½ì‘í•˜ê³  ê³µìœ í•˜ëŠ” í˜ì‹ ì ì¸ í”Œë«í¼ì…ë‹ˆë‹¤.
ì´ ì €ì¥ì†ŒëŠ” SONAì˜ ë°±ì—”ë“œ API ì„œë²„ë¡œ, NestJS + Prisma + PostgreSQL ê¸°ë°˜ìœ¼ë¡œ ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤

SONAëŠ” "ì€í•˜(ê°¤ëŸ­ì‹œ) â†’ í•­ì„±ê³„ â†’ í–‰ì„±(ê¶¤ë„/ì‚¬ìš´ë“œ)"ì„ êµ¬í˜„í•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ì´ ì €ì¥ì†ŒëŠ” NestJS, Prisma, PostgreSQLì„ ì‚¬ìš©í•˜ëŠ” ë°±ì—”ë“œ ë¶€ë¶„ì…ë‹ˆë‹¤.

## ğŸ› ê¸°ìˆ  ìŠ¤íƒ
[![Node.js](https://img.shields.io/badge/Node.js-18-green?style=flat-square&logo=node.js)](https://nodejs.org/)
[![NestJS](https://img.shields.io/badge/NestJS-11-red?style=flat-square&logo=nestjs)](https://nestjs.com/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.9-blue?style=flat-square&logo=typescript)](https://www.typescriptlang.org/)
[![Prisma](https://img.shields.io/badge/Prisma-6.14-blue?style=flat-square&logo=prisma)](https://www.prisma.io/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-16-blue?style=flat-square&logo=postgresql)](https://www.postgresql.org/)
[![Swagger](https://img.shields.io/badge/Swagger-API_Docs-green?style=flat-square&logo=swagger)](https://swagger.io/)


- **í”„ë ˆì„ì›Œí¬**: NestJS 11+
- **ë°ì´í„°ë² ì´ìŠ¤**: PostgreSQL 14+ (Prisma ORM ì‚¬ìš©)
- **ì¸ì¦**: JWT ê¸°ë°˜ ì¸ì¦
- **ë¬¸ì„œí™”**: Swagger API ë¬¸ì„œ


## ğŸ“– ì£¼ìš” ê¸°ëŠ¥
**ğŸµ ìŒì•… + ìš°ì£¼ íƒí—˜**

- ìŠ¤í…”ë¼ ì‹œìŠ¤í…œ(í•­ì„±ê³„) ìƒì„±: ì¤‘ì‹¬ë³„(Star) + í–‰ì„±(Planet) ì¡°í•©

- ì²œì²´ ì†ì„±ì´ ìŒì•…ì  ë§¤ê°œë³€ìˆ˜ë¡œ ë³€í™˜

- 6ê°€ì§€ ì•…ê¸° ì—­í•  ì§€ì› (ë² ì´ìŠ¤, ë“œëŸ¼, íŒ¨ë“œ, ë©œë¡œë””, ì•„ë¥´í˜ì§€ì˜¤, í™”ìŒ)

**ğŸ‘¥ ì»¤ë®¤ë‹ˆí‹° & ì†Œì…œ**

- íŒ”ë¡œìš°/ì–¸íŒ”ë¡œìš° + íŒ”ë¡œì›ŒÂ·íŒ”ë¡œì‰ ëª©ë¡ (ë§íŒ” ì—¬ë¶€ í™•ì¸ ê°€ëŠ¥)

- ì¢‹ì•„ìš”(Like) ê¸°ëŠ¥: ë‚´ê°€ ì¢‹ì•„ìš”í•œ í•­ì„±ê³„ ëª©ë¡ ì¡°íšŒ

- í´ë¡ (Clone): ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì‘í’ˆì„ ë¦¬ë¯¹ìŠ¤í•˜ì—¬ ì°½ì‘ í™•ì¥


**ğŸšï¸ ì œì–´ & ê´€ë¦¬**

- INFO íƒ­: ì‹œìŠ¤í…œ ì •ë³´ ë° ë©”íƒ€ë°ì´í„° ê´€ë¦¬

- OBJECTS íƒ­: ì²œì²´ ì¶”ê°€/ì‚­ì œ ë° ë°°ì¹˜

- PROPERTIES íƒ­: ìŒì•…ì  íŒŒë¼ë¯¸í„° ì„¸ë¶€ ì¡°ì •

- ì‹¤ì‹œê°„ ì˜¤ë””ì˜¤ í”Œë ˆì´ì–´ & ë³¼ë¥¨ ì»¨íŠ¸ë¡¤

## ğŸš€ ë°°í¬ ë§í¬

- **Frontend Live**: https://sona-sound.vercel.app/
- **ë¡œì»¬ ê°œë°œ**: [http://localhost:3000/api](http://localhost:3000/api)
- **ì˜¨ë¼ì¸ ë¬¸ì„œ**: [https://sona-sound-orbit-network-atlas.github.io/server/](https://sona-sound-orbit-network-atlas.github.io/server/)



## âš™ï¸ ê°œë°œ í™˜ê²½ ì„¤ì • (Backend)
### 0) ìš”êµ¬ì‚¬í•­
- **Node.js** â‰¥ 18
- **npm** â‰¥ 9
- **PostgreSQL** â‰¥ 14 (ë¡œì»¬ ë˜ëŠ” Docker)

### 1) ë ˆí¬ í´ë¡  & ì˜ì¡´ì„± ì„¤ì¹˜
``` bash
git clone <repository-url>
cd server
npm install
```

### 2) í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ (.env)

.env.sampleì„ ë³µì‚¬í•´ .envë¥¼ ë§Œë“  ë’¤ ê°’ì„ ì±„ì›Œì¤€ë‹¤.

``` bash
cp .env.sample .env
```

**ì˜ˆì‹œ(.env.sample ê¶Œì¥ ë‚´ìš©)**

``` bash
# ì„œë²„
PORT=3000
NODE_ENV=development

# DB (ë¡œì»¬ Postgres ì˜ˆì‹œ)
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/sona?schema=public"

# ì¸ì¦
JWT_SECRET="replace_with_a_secure_random_secret"

# ì—…ë¡œë“œ ë””ë ‰í„°ë¦¬(ì ˆëŒ€ ê²½ë¡œ ê¶Œì¥, ì—†ìœ¼ë©´ ./data/uploads ì‚¬ìš©)
# UPLOAD_DIR=/absolute/path/to/uploads
```

> Windowsì—ì„œ DATABASE_URLì— ë”°ì˜´í‘œ ë¬¸ì œë¡œ ì˜¤ë¥˜ê°€ ë‚˜ë©´ ìŒë”°ì˜´í‘œ ìœ ì§€í•œ ì±„ ìœ íš¨í•œ ë¬¸ìì—´ì¸ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”.

### 3) ë°ì´í„°ë² ì´ìŠ¤ ì¤€ë¹„
**(A) ë¡œì»¬ì— ì´ë¯¸ Postgresê°€ ìˆë‹¤ë©´**

- postgres ìœ ì €/ë¹„ë°€ë²ˆí˜¸ì™€ DB ì´ë¦„(sona)ì„ ë¯¸ë¦¬ ë§Œë“¤ì–´ ë‘ê±°ë‚˜,

- .envì˜ DATABASE_URLì„ í™˜ê²½ì— ë§ê²Œ ìˆ˜ì •.

 **(B) Dockerë¡œ ê°„ë‹¨íˆ ì‹¤í–‰ (ì¶”ì²œ)**

ë„ì»¤ê°€ ìˆë‹¤ë©´ ì•„ë˜ í•œ ì¤„ë¡œ Postgresë¥¼ ë„ìš¸ ìˆ˜ ìˆìŒ.

``` bash
docker run -d \
  --name sona-postgres \
  -e POSTGRES_USER=postgres \
  -e POSTGRES_PASSWORD=postgres \
  -e POSTGRES_DB=sona \
  -p 5432:5432 \
  -v sona_pgdata:/var/lib/postgresql/data \
  postgres:14
```

> í¬íŠ¸ ì¶©ëŒ ì‹œ -p 5433:5432ì²˜ëŸ¼ ì¢Œì¸¡ í¬íŠ¸ë¥¼ ë°”ê¾¸ê³  DATABASE_URLë„ localhost:5433ìœ¼ë¡œ ë§ì¶°ì•¼ í•´ìš”.

### 4) Prisma ì¤€ë¹„ (ë§ˆì´ê·¸ë ˆì´ì…˜/í´ë¼ì´ì–¸íŠ¸ ìƒì„±)

``` bash
# ìŠ¤í‚¤ë§ˆ ì ìš© (ë§ˆì´ê·¸ë ˆì´ì…˜)
npm run db:migrate:dev
# ë˜ëŠ” ì´ë¦„ ì§€ì •
# npx prisma migrate dev --name init

# í´ë¼ì´ì–¸íŠ¸ ì¬ìƒì„±(í•„ìš” ì‹œ)
npm run db:generate

# (ì„ íƒ) ì‹œë“œ ë°ì´í„°ê°€ ìˆë‹¤ë©´
# npx prisma db seed

# (ì„ íƒ) GUIë¡œ ë°ì´í„° ë³´ê¸°
npm run db:studio
```

> ìŠ¤í‚¤ë§ˆë¥¼ ìì£¼ ë°”ê¾¼ë‹¤ë©´ npm run db:migrate:resetë¡œ ì´ˆê¸°í™” â†’ ë‹¤ì‹œ devë¥¼ ì ìš©í•˜ë©´ ê¹”ë”í•´ì ¸ìš”.

### 5) ê°œë°œ ì„œë²„ ì‹¤í–‰ & ë¬¸ì„œ í™•ì¸
``` bash
npm run start:dev
```

- ì„œë²„: http://localhost:3000

- Swagger ë¬¸ì„œ: http://localhost:3000/api

> ë§Œì•½ Swaggerê°€ ë³´ì´ì§€ ì•Šìœ¼ë©´ main.ts(ë˜ëŠ” Swagger ì„¤ì • ìŠ¤í¬ë¦½íŠ¸)ê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€, export:swagger/swagger:ui:prepare ìŠ¤í¬ë¦½íŠ¸ê°€ ìµœì‹ ì¸ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”.

### 6) ìœ ìš©í•œ ìŠ¤í¬ë¦½íŠ¸ (ìš”ì•½)
``` bash
"scripts": {
  "start:dev": "nest start --watch",
  "start:prod": "node dist/main",
  "db:migrate:dev": "prisma migrate dev --skip-generate",
  "db:generate": "prisma generate",
  "db:migrate:reset": "prisma migrate reset --skip-generate",
  "db:studio": "prisma studio",
  "export:swagger": "ts-node scripts/export-swagger.ts",
  "swagger:ui:prepare": "npm run export:swagger && ts-node scripts/copy-swagger-ui.ts"
}
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/
â”œâ”€â”€ auth/                # ì¸ì¦ ê´€ë ¨ ê¸°ëŠ¥
â”œâ”€â”€ common/              # ê³µí†µ ìœ í‹¸ë¦¬í‹°, í•„í„°, ì¸í„°ì…‰í„°
â”œâ”€â”€ modules/             # ë„ë©”ì¸ë³„ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ follows/         # íŒ”ë¡œìš° ê´€ë¦¬
â”‚   â”œâ”€â”€ likes/           # ì¢‹ì•„ìš” ê´€ë¦¬
â”‚   â”œâ”€â”€ stellar-systems/ # í•­ì„±ê³„ ê¸°ëŠ¥
â”‚   â””â”€â”€ users/           # ì‚¬ìš©ì ê¸°ëŠ¥
â”œâ”€â”€ prisma/              # Prisma ê´€ë ¨ ì½”ë“œ
â”œâ”€â”€ app.module.ts        # ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ëª¨ë“ˆ
â””â”€â”€ main.ts              # ì• í”Œë¦¬ì¼€ì´ì…˜ ì§„ì…ì 
```

## ğŸ“šAPI ì—”ë“œí¬ì¸íŠ¸

ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸:

- `POST /api/auth/signup`: ì‚¬ìš©ì íšŒì›ê°€ì…
- `POST /api/auth/login`: ì‚¬ìš©ì ë¡œê·¸ì¸ ë° JWT í† í° ë°œê¸‰
- `GET /api`: Swagger API ë¬¸ì„œ

ìì„¸í•œ API ë¬¸ì„œëŠ” ì„œë²„ ì‹¤í–‰ í›„ http://localhost:3000/api ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


